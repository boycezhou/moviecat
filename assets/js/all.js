!function(o){var e=o.module("moviecat",["moviecat_home","moviecat_details","moviecat_movieList"]);e.config(["$locationProvider",function(o){o.hashPrefix("")}]),e.controller("searchCtrl",["$scope","$window",function(o,e){o.search=function(){e.location.hash="#/search?q="+o.val}}])}(angular),function(o){var e=o.module("moviecat_details",["ngRoute"]);e.config(["$routeProvider",function(o){o.when("/details/:id",{templateUrl:"./details/details.html",controller:"detailsCtrl"})}]),e.controller("detailsCtrl",["$scope","$routeParams","qJsonp",function(o,e,t){o.isShow=!0,t.jsonp({url:"https://api.douban.com/v2/movie/subject/"+e.id,callback:function(e){console.log(e),o.data=e,o.isShow=!1,o.$apply()}})}])}(angular),function(o){var e=o.module("moviecat_home",["ngRoute"]);e.config(["$routeProvider",function(o){o.when("/home",{templateUrl:"./home/home.html",controller:"homeCtrl"}).when("/",{redirectTo:"/home"})}]),e.controller("homeCtrl",["$scope","qJsonp","$rootScope",function(o,e,t){t.active="home"}])}(angular),function(o){var e=o.module("moviecat_movieList",["ngRoute","qService"]);e.config(["$routeProvider",function(o){o.when("/:movieType/:page?",{templateUrl:"./movieList/movieList.html",controller:"movieListCtrl"})}]),e.controller("movieListCtrl",["$scope","$rootScope","$routeParams","$route","$window","qJsonp",function(o,e,t,a,i,n){o.isShow=!0,e.active=t.movieType,o.pageSize=5,o.pageIndex=+(t.page||"1"),n.jsonp({url:"https://api.douban.com/v2/movie/"+t.movieType,data:{count:o.pageSize,start:(o.pageIndex-1)*o.pageSize,q:t.q},callback:function(e){o.movies=e,o.total=e.total,o.totalPage=i.Math.ceil(o.total/o.pageSize),o.isShow=!1,o.$apply()}}),o.getPage=function(e){o.pageIndex=e,a.updateParams({page:e})}}])}(angular),function(o){o.module("qService",[]).service("qJsonp",["$window",function(o){this.jsonp=function(e){var t=e.url+"?";if(e.data)for(var a in e.data)t+=a+"="+e.data[a]+"&";var i="callback"+ +new Date;t+="callback="+i,o[i]=e.callback;var n=o.document.createElement("script");n.src=t,o.document.body.appendChild(n)}}])}(angular);